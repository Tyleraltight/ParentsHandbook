# ğŸ›¡ï¸ ParentsHandbook

**ParentsHandbook (å®¶é•¿å†…å®¹é¡¾é—®)** is an AI-powered movie and TV show analysis tool designed to help parents quickly determine the appropriateness of media content for their children. By scraping IMDb's Parental Guide and distilling it through advanced LLMs (Google Gemini), it provides a fast, structured, and easy-to-read content rating across four critical dimensions.

**English** | [ä¸­æ–‡ç‰ˆ](README_zh.md)

---

## ğŸš€ Features

- **Streaming Analysis (SSE)**: progressive UI rendering that streams JSON objects from the LLM. You don't have to wait 30 seconds for the entire analysis to finish. Results "pop" onto the screen instantly as they are parsed!
- **Data Scraping & Fallback**: Scrapes parental guides directly from IMDb. Features built-in resilience against intermittent anti-bot blocking (202 responses) via fallback rendering and cache healing mechanisms. 
- **AI-Powered Distillation**: Leverages Gemini 3 Flash for granular per-dimension scoring and Gemini 3 Pro for comprehensive overall conclusions.
- **Smart Caching Mechanism**: Complete metadata (Title, Poster, Year, etc.) and analysis scores are cached on disk for instantaneous future retrievals. TV Series metadata extraction from TMDb is supported.
- **Dark Mode Aesthetic**: A premium, minimalist UI designed for readability and focus.

---

## ğŸ› ï¸ Architecture

The backend operates on a parallel processing and streaming architecture using FastAPI:

1. **Resolver (`movie_resolver.py`)**: Connects to the TMDb API to match search strings to IMDb IDs and retrieve movie/TV metadata (posters, release years).
2. **Scraper (`http_scraper.py`)**: Uses randomized User-Agents and BeautifulSoup4 to extract the raw text blocks for *Sex & Nudity*, *Violence & Gore*, *Profanity*, and *Frightening Scenes* from IMDb.
3. **LLM Reasoner (`llm_reasoner.py`)**: 
   - Uses a streaming generator to process the scraped text in a single efficient prompt. 
   - A custom brace-counting JSON parser intercepts the stream and yields dimension scores sequentially.
4. **API (`api.py`)**: Exposes an SSE endpoint (`/analyze/stream`) to relay results incrementally to the frontend.

---

## âš™ï¸ Installation & Setup

### Prerequisites

- Python 3.9+
- [TMDB API Key](https://developer.themoviedb.org/docs/getting-started)
- [Google Gemini API Key](https://aistudio.google.com/app/apikey)

### 1. Clone the repository

```bash
git clone https://github.com/Tyleraltight/ParentsHandbook.git
cd ParentsHandbook
```

### 2. Environment Configuration

Create a `.env` file in the root directory and configure your keys:

```env
GOOGLE_API_KEY="your-gemini-api-key-here"
TMDB_API_KEY="your-tmdb-api-key-here"
ADMIN_KEY="your-secret-admin-key" # Used for forcing a cache refresh
```

### 3. Install Dependencies

You can use a virtual environment or install dependencies directly:

```bash
pip install -r requirements.txt
```

### 4. Run the Server

Start the local Uvicorn server:

```bash
python -m uvicorn src.api:app --host 127.0.0.1 --port 8001
```

Access the UI locally at: `http://127.0.0.1:8001`

---

## ğŸ” How to Use

1. **Search**: Enter the name of a movie or TV show (e.g., "Inception 2010" or "Breaking Bad"). Include the year if the title is generic.
2. **Analyze**: Click Analyze. The UI will instantly show the poster and metadata, followed by individual score cards popping up as the AI finishes reasoning about each dimension.
3. **Review**: Check the specific 1-10 scores, exact quotes from the source material, and the AI's final maturity recommendation.
4. **Refresh**: Admins can triple-click the Title of the web page to reveal a hidden modal. Entering the `ADMIN_KEY` permits forcing an audit (bypassing the cache).

---

## ğŸ“„ License & Disclaimer

- The text retrieved from IMDb's Parental Guide is used strictly for analytical purposes under fair use.
- Content generated by the LLM relies on user-submitted data and should be verified independently if critical decisions are being made regarding media consumption.

**Built with â¤ï¸ using fastAPI + Gemini.**
